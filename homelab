#!/bin/bash

source $(dirname $0)/DOCKER/scripts/help.sh
source $(dirname $0)/DOCKER/scripts/utils.sh
source $(dirname $0)/DOCKER/scripts/sites.sh
source $(dirname $0)/DOCKER/scripts/installer.sh
source $(dirname $0)/DOCKER/scripts/docker.sh

cd $(dirname $0)
set -a && source DOCKER/.env && set +a
R1 $WHITE "Compose use: ${COMPOSE_PROJECT_NAME^^} ✔" $LIGTH_GREEN "☑" "."
shift $((OPTIND -1))

subcommand=$1; shift

case "$subcommand" in
  up)
    docker_up
    echo -e " ${LIGTH_GREEN}✔${NC} WWW\t\t\t\t      ${GREEN}Https://www.${COMPOSE_PROJECT_NAME,,}.local/${NC}\n"
  ;;
  ps)
    docker_ps
  ;;
  help)
    help
  ;;
  install)
    installer
  ;;
  logs)
    docker_logs "$@"
  ;;
  bash)
    docker_bash "$@"
  ;;
  php8)
    docker_bash "homelab-php8"
  ;;
  php7)
    docker_bash "homelab-php7"
  ;;
  php8-usr)
    docker_bash "homelab-php8" "${USERNAME}"
  ;;
  php7-usr)
    docker_bash "homelab-php7" "${USERNAME}"
  ;;
  newsite)
    newsite $@
  ;;
  down)
    docker_down "$@"
  ;;
  *)
    R1 $RED "Invalid command" $LIGTH_RED "✘" "."
    colorize $LIGTH_RED "   \'$subcommand\'   "
    ln
    help
  ;;
esac
dockerV=$(docker -v)
L1 $GREEN "${dockerV}" $WHITE "☑" "."